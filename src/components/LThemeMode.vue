<script setup lang="ts">
import type { AnimateBase, DefaultMode } from '../@types/Props'

import { ref, watch } from 'vue'

const emit = defineEmits<{
  (e: 'update:modelValue', model: boolean): void
}>()
const props = withDefaults(
  defineProps<{
    modelValue: boolean
    widthClass?: string
    heightClass?: string
    defaultMode?: DefaultMode
    disabled?: boolean
    animate?: AnimateBase
  }>(),
  {
    widthClass: 'w-10',
    heightClass: 'h-10',
    defaultMode: 'dark',
    disabled: false,
    animate: 'rotate'
  }
)
const check = ref(props.modelValue)

watch(
  () => props.modelValue,
  (value) => {
    check.value = value
  }
)
watch(check, (value) => {
  if (!props.disabled) {
    emit('update:modelValue', value)
  }
})
</script>

<template>
  <label
    :disabled="$props.disabled"
    :class="[
      'swap',
      {
        'swap-rotate': $props.animate === 'rotate',
        'swap-flip': $props.animate === 'flip'
      }
    ]"
  >
    <!-- this hidden checkbox controls the state -->
    <input v-model="check" type="checkbox" class="theme-controller" :value="$props.defaultMode" />

    <!-- sun icon -->
    <svg
      :class="[
        'fill-current',
        $props.widthClass,
        $props.heightClass,
        {
          'swap-off': $props.defaultMode === 'light',
          'swap-on': $props.defaultMode !== 'light'
        }
      ]"
      viewBox="0 0 1024 1024"
      version="1.1"
      xmlns="http://www.w3.org/2000/svg"
    >
      <path
        d="M512 428.9c45.8 0 83.1 37.2 83.1 83.1 0 45.8-37.3 83.1-83.1 83.1s-83.1-37.3-83.1-83.1c0-45.9 37.3-83.1 83.1-83.1m0-83.1c-91.8 0-166.2 74.4-166.2 166.2 0 91.8 74.4 166.2 166.2 166.2 91.8 0 166.2-74.4 166.2-166.2 0-91.8-74.4-166.2-166.2-166.2M512 262.7c-22.9 0-41.5-18.6-41.5-41.5v-83.1c0-23 18.6-41.5 41.5-41.5s41.5 18.6 41.5 41.5v83.1c0.1 22.9-18.5 41.5-41.5 41.5M717.7 347.9c-10.6 0-21.3-4-29.4-12.1-16.2-16.3-16.2-42.5 0-58.8l58.8-58.8c16.2-16.2 42.5-16.2 58.8 0 16.3 16.3 16.3 42.5 0 58.8l-58.8 58.8c-8.1 8-18.8 12.1-29.4 12.1M886 553.6h-83.1c-22.9 0-41.5-18.6-41.5-41.5s18.6-41.6 41.5-41.6H886c23 0 41.5 18.6 41.5 41.6 0 22.9-18.6 41.5-41.5 41.5M776.4 818c-10.6 0-21.3-4.1-29.4-12.2L688.2 747c-16.2-16.2-16.2-42.5 0-58.7 16.3-16.2 42.5-16.2 58.8 0l58.8 58.7c16.3 16.3 16.3 42.6 0 58.8-8.1 8.1-18.8 12.2-29.4 12.2M511.9 927.5c-23 0-41.5-18.6-41.5-41.5v-83.1c0-22.9 18.6-41.5 41.5-41.5s41.5 18.6 41.5 41.5V886c0.1 22.9-18.6 41.5-41.5 41.5M247.5 817.9c-10.6 0-21.3-4-29.4-12.1-16.2-16.3-16.2-42.6 0-58.8l58.8-58.8c16.2-16.2 42.5-16.2 58.8 0 16.2 16.3 16.2 42.5 0 58.8l-58.8 58.8c-8.1 8.1-18.8 12.1-29.4 12.1M221.1 553.4H138c-22.9 0-41.5-18.6-41.5-41.5 0-23 18.6-41.5 41.5-41.5h83.1c22.9 0 41.5 18.6 41.5 41.5 0.1 22.9-18.5 41.5-41.5 41.5M306.4 347.8c-10.6 0-21.3-4.1-29.4-12.2l-58.8-58.7a41.465 41.465 0 0 1 0-58.8c16.3-16.2 42.5-16.2 58.8 0l58.8 58.8c16.3 16.2 16.3 42.5 0 58.7-8.1 8.1-18.8 12.2-29.4 12.2"
      ></path>
    </svg>

    <!-- moon icon -->
    <svg
      :class="[
        'fill-current',
        $props.widthClass,
        $props.heightClass,
        {
          'swap-on': $props.defaultMode === 'light',
          'swap-off': $props.defaultMode !== 'light'
        }
      ]"
      viewBox="0 0 1024 1024"
      version="1.1"
      xmlns="http://www.w3.org/2000/svg"
    >
      <path
        d="M676.64 72.373333a21.333333 21.333333 0 0 0-28.426667 24.96c7.733333 32 17.333333 77.973333 17.333334 108.64a407.36 407.36 0 0 1-585.173334 366.4 21.333333 21.333333 0 0 0-30.293333 23.04 469.333333 469.333333 0 0 0 485.333333 385.333334c243.84-11.84 439.413333-212.16 445.76-456.213334a469.333333 469.333333 0 0 0-304.533333-452.16zM512 906.666667a395.306667 395.306667 0 0 1-357.333333-226.4 2.186667 2.186667 0 0 1 2.453333-3.04 480 480 0 0 0 100.96 10.666666 482.506667 482.506667 0 0 0 481.92-481.92v-11.68a2.186667 2.186667 0 0 1 3.466667-1.813333 395.52 395.52 0 0 1 81.44 78.986667A390.826667 390.826667 0 0 1 906.666667 512a395.146667 395.146667 0 0 1-394.666667 394.666667zM202.293333 262.72a8.96 8.96 0 0 0 2.88 0.426667 75.946667 75.946667 0 0 1 75.733334 75.733333 7.626667 7.626667 0 0 0 0.48 2.88 11.52 11.52 0 0 0 22.186666 0 8.746667 8.746667 0 0 0 0.426667-2.88 76 76 0 0 1 75.733333-75.733333 8.746667 8.746667 0 0 0 2.88-0.426667 11.573333 11.573333 0 0 0 0-22.24 8.746667 8.746667 0 0 0-2.88-0.426667A75.946667 75.946667 0 0 1 304 164.32a8.746667 8.746667 0 0 0-0.426667-2.88 11.52 11.52 0 0 0-22.186666 0 7.626667 7.626667 0 0 0-0.48 2.88A75.893333 75.893333 0 0 1 205.386667 240a8.96 8.96 0 0 0-2.88 0.426667 11.573333 11.573333 0 0 0 0 22.24z"
      ></path>
    </svg>
  </label>
</template>
